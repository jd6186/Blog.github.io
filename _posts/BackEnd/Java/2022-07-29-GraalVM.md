---
layout: post
title: "[GraalVM] JVM이 아닌 GraalVM"
tags: [BackEnd JAVA]
---

## Intro

안녕하세요 **Noah**입니다

오늘은 GraalVM에 대해 알아보도록 하겠습니다.
GraalVM은 Java, Javascript, Python, Ruby, 등을 지원하는 Virtual Machine입니다.<br/>

https://www.graalvm.org/java/
<img src="../../../assets/img/2022-07-29-GraalVM/GraalVM.png"  width="700"/>

기존 Java에는 JVM이 존재했습니다. Javac를 통해 컴파일된 Class파일들은 JVM 내 Class Loader를 통해 Class파일들을 JVM 내부에 할당합니다.<br/>
이후 필요한 class 파일들을 Execution Engine을 통해 해석하고 Runtime Area에 배치함으로써 Application이 실행되게 됩니다.<br/>
Application이 작동하는 동안 JVM은 GC를 이용해 메모리 관리를 하기도 하고 Thread 싱크를 맞춰주기도 합니다.

GraalVM은 Java로 구현된 HotSpot/OpenJDK 기반의 Java VM 및 JDK를 지원하는 오픈소스입니다. JDK 8, 11 버전과 호환이 가능하기 때문에 따로 소스코드를 변환할 필요가 없습니다.
또한 Spring, Tomcat 등 기존 Java 서버 개발자분들과 친숙한 Framework들과 호환성도 좋아 한번 사용해 보시는 걸 추천드립니다.

이제 GraalVM을 왜 사용해야 하는지 그리고 GraalVM의 등장으로 어떤 것들이 새롭게 등장했는지 살펴보도록 하겠습니다.
<br/><br/><br/><br/>

## GraalVM은 왜 등장했을까?
기존 레거시 환경에서는 큰 문제가 없었던 OpenJDK였지만 Docker/Kubernatis 등이 등장하며 컨테이너 작업이 많아지는 시점부터 로딩 속도가 느리다는 단점이 계속 지적되어 왔습니다.
이런 이슈를 해결하고자 Oracle에서는 New JIT Compiler인 Graal Compiler를 선보였습니다.

이 Graal Compiler의 특징은 다음과 같습니다.
1. Garbage Collection 알고리즘 개선
2. Runtime Memory 구조 개선
3. Java Library 효율성 향상
4. CPU 최적화
5. Just In Time(JIT) 컴파일러 도입

위 내용들을 통해 Java의 성능이 대폭 상승하였고 아래와 같은 부가 효과를 가져오게 되었습니다.

1. 빠른 스타트 시간
2. 단위 시간당 최대 처리량 증가
3. 동일 작업 간 낮은 메모리 사용량
4. 패키지 파일 용량 감소
5. 지연시간 최소화

위 내용 모두가 다 Container 환경에서 작업을 할 때 필요한 요소들이라 사람들은 
GraalVM은 컨테이너 환경에 대응하기 위해 Oracle이 새롭게 VM을 개발한 것이라고 이야기가 나오는 것 같습니다.

> 더 자세한 내용은 아래 문서를 참고해보세요 ^^
> http://www.regist-event.com/oracle/2019/mcd_down/pdf/Day1_Track4/Day1_T4_S1.%20Cloud%20Native%20Java%20GraalVM%20-%20%EA%B9%80%ED%83%9C%EC%99%84%20%EB%B6%80%EC%9E%A5.pdf

## GraalVM의 장점
GraalVM의 장점은 크게 3가지입니다.
1. 인프라 비용 절감
   1. 기존 JVM보다 더 높은 애플리케이션 성능과 더 낮은 CPU 및 메모리 사용량을 제공하기 때문에 인프라에 대한 비용을 절감할 수 있게 됩니다.
2. 코드 변경 없이 더 나은 성능 제공
   1. OpenJDK 8, 11 버전에 맞게 설치를 제공하며 이들과 완벽하게 호응되어 코드 변경없이 서비스를 마이그레이션 가능합니다.
3. 여러 고성능 Framework 대응
   - Micronaut, Helidon, <strong style="color: #bb4177;">'Quarkus'</strong>, or Spring Boot for microservices, PicoCLI 등을 지원합니다.
4. Java 생태계를 확장 가능
   - GraalVM을 사용하면 JVM 위에서 다른 언어들을 사용 가능하며 이를 통해 다양한 서비스를 생산해 낼 수 있습니다.
      - Scala, Kotlin, Clojure, JavaScript/Node.js, Ruby, Python, R 등의 언어를 JVM 위에서 가용하도록 GraalVM이 지원합니다.
      - C, C++과 같은 컴파일 언어들도 LLVM bitcode 또는 WebAssembly(Wasm)로 컴파일하여 사용할 수 있도록 지원합니다.
      - 이를 통해 Python 기계 학습 기능을 통합하는 Java 마이크로서비스 제작 <br/>또는 통계 데이터 분석에 R을 사용하고 JavaScript를 이용해 프로그래밍한 서비스 등을 지원할 수 있게 됩니다. 


## GraalVM과 Quarkus를 활용해 간단히 서버 띄우는 방법